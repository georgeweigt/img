PROGRAM MERGE_DEMO;

(* THIS PROGRAM DEMONSTRATES
   SYSTEM UTILITIES MERGE
   ROUTINE.

   COPYRIGHT (C) 1986
   KYAN SOFTWARE, INC.  *)


TYPE
#I SRTMERG.TYPES.I

VAR
#I SRTMERG.VARS.I
CH:CHAR;


#I MERGE.I

PROCEDURE HOME;
BEGIN
#A
 STX _T
 JSR $FC58
 LDX _T
#
END;


PROCEDURE MAKETXT(VAR PATHNAME:PATHSTRING);
BEGIN
#A
 STX _T
 LDY #5
 JSR MAKEPATH
 LDA _T+2
 STA MTXTL+1
 LDA _T+3
 STA MTXTL+2
 LDA #10        ;PARM COUNT
 STA MTXTL
 JSR _MLI
 DB  $C4        ;GET_FILE_INFO
 DW  MTXTL
 LDA #4         ;TXT
 STA MTXTL+4
 LDA #7
 STA MTXTL
 JSR _MLI
 DB  $C3
 DW  MTXTL
 LDX _T
#
END;
#A
MTXTL EQU *
 DS 18
#



BEGIN
   HOME;
   WRITELN('*** MERGE ROUTINE DEMO ***');
   WRITELN;
   WRITELN('THE MERGE ROUTINE TAKES ORDERED FILES');
   WRITELN('AND MERGES THEM INTO 1 LARGE FILE.');
   WRITELN('ALTHOUGH IT IS PRIMARILY USED IN');
   WRITELN('CONJUNCTION WITH ESORT, YOU CAN USE');
   WRITELN('MERGE AS A STAND ALONE UTILITY...');
   WRITELN;
   WRITELN('IN ORDER TO USE THIS DEMO');
   WRITELN('CORRECTLY, IT MUST BE ABLE');
   WRITELN('TO FIND FILES "MERGE.DEMO.1"');
   WRITELN('AND "MERGE.DEMO.2" IN THE');
   WRITELN('CURRENT DIRECTORY.');
   WRITE('IS IT OK TO PROCEED? (Y/N)');
   READLN(CH);
   IF CH='Y' THEN
   BEGIN
      WRITELN('MERGING.....');
      MERGENAME[1]:=
   'MERGE.DEMO.1                                                     ';
   MERGENAME[2]:=
   'MERGE.DEMO.2                                                     ';
   MERGENAME[6]:=
   'DESTFILE                                                         ';
   MERGENAME[7]:=
   'FINALFILE                                                        ';
   MERGE(MERGENAME,7,2,7,5,0,1,ALPHA_FIELD);
   MAKETXT(MERGENAME[7]);
   WRITELN('USE "ED" TO SEE THE RESULTS IN');
   WRITELN('FILE "FINALFILE".')
  END
END.
